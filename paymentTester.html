<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ECPay Demo</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="container" id="container">
      <div class="row justify-content-center">
        <div class="col-12 col-lg-6">
          <div class="mb-3">
            <label for="authorization" class="form-label">authorization</label>
            <input
              type="text"
              class="form-control"
              id="authorization"
              name="authorization"
              placeholder="Bearer ......"
              value="Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY0NWNmZTQyODEyOTI2NjEzNTY5NTZjZCIsImlhdCI6MTY4NTUxMDk3NSwiZXhwIjoxNjg2MTE1Nzc1fQ.nVUqtdoP86cA1ds6OxdSo4tq_oSIHwlrlsEAD_YAFPo"
            />
          </div>
          <form id="test-form">
            <div class="mb-3">
              <label for="project-id" class="form-label">project id</label>
              <input
                type="text"
                class="form-control"
                id="project-id"
                name="projectId"
                placeholder=""
                value="6475a6aec4fd1fa3434b66ff"
              />
            </div>
            <div class="mb-3">
              <label for="product-id" class="form-label">product id</label>
              <input
                type="text"
                class="form-control"
                id="product-id"
                name="productId"
                placeholder=""
              />
            </div>
            <div class="mb-3">
              <label for="plan-id" class="form-label">plan id</label>
              <input
                type="text"
                class="form-control"
                id="plan-id"
                name="planId"
                placeholder=""
                value="6475b3e7c4fd1fa3434b6726"
              />
            </div>
            <div class="mb-3">
              <label for="payment" class="form-label">payment</label>
              <input
                type="text"
                class="form-control"
                id="payment"
                name="payment"
                placeholder="只能是 0 信用卡支付"
                value="0"
              />
            </div>
            <div class="mb-3">
              <label for="fund-price" class="form-label">fund price</label>
              <input
                type="text"
                class="form-control"
                id="fund-price"
                name="fundPrice"
                placeholder="回饋方案金額"
                value="100"
              />
            </div>
            <div class="mb-3">
              <label for="count" class="form-label">count</label>
              <input
                type="text"
                class="form-control"
                id="count"
                name="count"
                placeholder="數量"
                value="1"
              />
            </div>
            <div class="mb-3">
              <label for="bonus-discount" class="form-label"
                >bonus discount</label
              >
              <input
                type="text"
                class="form-control"
                id="bonus-discount"
                name="bonusDiscount"
                placeholder="紅利折抵"
                value="0"
              />
            </div>
            <div class="mb-3">
              <label for="ship-price" class="form-label">ship price</label>
              <input
                type="text"
                class="form-control"
                id="ship-price"
                name="shipPrice"
                placeholder="運費"
                value="60"
              />
            </div>
            <div class="mb-3">
              <label for="shipment" class="form-label">shipment</label>
              <input
                type="text"
                class="form-control"
                id="shipment"
                name="shipment"
                placeholder="只有 0 宅配"
                value="0"
              />
            </div>
            <div class="mb-3">
              <label for="extra-fund" class="form-label">extra fund</label>
              <input
                type="text"
                class="form-control"
                id="extra-fund"
                name="extraFund"
                placeholder="額外贊助"
                value="100"
              />
            </div>
            <div class="mb-3">
              <label for="total" class="form-label">total</label>
              <input
                type="text"
                class="form-control"
                id="total"
                name="total"
                placeholder="總金額"
                value="260"
              />
            </div>
            <div class="mb-3">
              <label for="buyer-name" class="form-label">buyer name</label>
              <input
                type="text"
                class="form-control"
                id="buyer-name"
                name="buyerName"
                placeholder="購買人姓名"
                value="Hex School"
              />
            </div>
            <div class="mb-3">
              <label for="buyer-phone" class="form-label">buyer phone</label>
              <input
                type="text"
                class="form-control"
                id="buyer-phone"
                name="buyerPhone"
                placeholder="購買人電話"
                value="0912345678"
              />
            </div>
            <div class="mb-3">
              <label for="buyer-email" class="form-label">buyer email</label>
              <input
                type="text"
                class="form-control"
                id="buyer-email"
                name="buyerEmail"
                placeholder="購買人 email"
                value="test@123.com"
              />
            </div>
            <div class="mb-3">
              <label for="buyer-address" class="form-label"
                >buyer address</label
              >
              <input
                type="text"
                class="form-control"
                id="buyer-address"
                name="buyerAddress"
                placeholder="購買人地址"
                value="臺中市西屯區"
              />
            </div>
            <div class="mb-3">
              <label for="ship-address" class="form-label">ship address</label>
              <input
                type="text"
                class="form-control"
                id="ship-address"
                name="shipAddress"
                placeholder="收件地址"
                value="臺中市西屯區"
              />
            </div>
            <div class="mb-3">
              <label for="recipient" class="form-label">recipient</label>
              <input
                type="text"
                class="form-control"
                id="recipient"
                name="recipient"
                placeholder="收件人"
                value="hex"
              />
            </div>
            <div class="mb-3">
              <label for="recipient-phone" class="form-label"
                >recipient phone</label
              >
              <input
                type="text"
                class="form-control"
                id="recipient-phone"
                name="recipientPhone"
                placeholder="收件人電話"
                value="0912345678"
              />
            </div>
            <div class="mb-3">
              <label for="recipient-email" class="form-label"
                >recipient email</label
              >
              <input
                type="text"
                class="form-control"
                id="recipient-email"
                name="recipientEmail"
                placeholder="收件人 email"
                value="test@123.com"
              />
            </div>
            <div class="mb-3">
              <label for="note" class="form-label">note</label>
              <input
                type="text"
                class="form-control"
                id="note"
                name="note"
                placeholder="訂單備註"
                value="note"
              />
            </div>
            <button class="btn btn-primary" type="button" id="test">
              test
            </button>
          </form>
        </div>
      </div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"
      integrity="sha512-uMtXmF28A2Ab/JJO2t/vYhlaa/3ahUOgj1Zf27M5rOo8/+fcTUVH0/E0ll68njmjrLqOBjXM3V9NiPFL5ywWPQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script>
      document.querySelector('#test').addEventListener('click', () => {
        const auth = document.querySelector(
          'input[name="authorization"]'
        ).value;
        const form = document.querySelector('#test-form');
        const form_data = new FormData(form);
        const data = {};
        form_data.forEach((value, key) => {
          data[key] = value;
        });
        axios({
          url: '/order/payment',
          method: 'post',
          data,
          headers: {
            Authorization: auth
          }
        })
          .then((res) => {
            const newDiv = document.createElement('div');
            newDiv.innerHTML = res.data.data;
            document.querySelector('#container').appendChild(newDiv);
            document.forms['payment'].submit();
          })
          .catch((error) => {
            if (error.response) {
              // The request was made and the server responded with a status code
              // that falls out of the range of 2xx
              alert(error.response.data.message);
              // alert(error.response.status);
              // alert(error.response.headers);
            } else if (error.request) {
              // The request was made but no response was received
              // `error.request` is an instance of XMLHttpRequest in the browser
              // and an instance of http.ClientRequest in node.js
              alert(error.request);
            } else {
              // Something happened in setting up the request that triggered an Error
              alert('Error', error.message);
            }
          });
      });
    </script>
  </body>
</html>
